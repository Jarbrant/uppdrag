<!-- ============================================================
     FIL: pages/play.html  (HEL FIL)
     AO 6/15 + AO 14/15 + AO 3/6 (FAS 1.1) ‚Äî Play page UI + difficulty toggle
     M√•l: Segmented control (Easy/Normal) med tydliga hooks
============================================================ -->
<!doctype html>
<html lang="sv">
<head>
  <!-- ==========================================================
       BLOCK 1 ‚Äî Meta + CSS
  =========================================================== -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Spela ‚Äî Uppdrag</title>
  <meta name="description" content="Spelvy f√∂r uppdrag och progression." />
  <link rel="stylesheet" href="../styles/main.css" />
</head>

<body>
  <!-- ==========================================================
       BLOCK 2 ‚Äî Skip link (A11y)
  =========================================================== -->
  <a class="skipLink" href="#mainContent">Hoppa till inneh√•ll</a> <!-- HOOK: skip-link -->

  <!-- ==========================================================
       BLOCK 3 ‚Äî App Root
  =========================================================== -->
  <div id="app" class="app"> <!-- HOOK: app-root -->
    <!-- ========================================================
         BLOCK 4 ‚Äî Header
    ========================================================= -->
    <header class="topbar">
      <div class="topbar__inner">
        <div class="row row--header">
          <button id="backBtn" class="btn btn-ghost btn--icon" type="button" aria-label="Tillbaka">
            ‚Üê
          </button>
          <!-- HOOK: back-button -->

          <div class="headerTitle">
            <div class="muted small">Paket</div>
            <div id="packName" class="headerName">‚Äî</div>
            <!-- HOOK: pack-name -->
          </div>

          <div class="headerRight">
            <span id="levelPill" class="pill pill--level" data-hook="level-pill" aria-label="Nuvarande level">Lvl 1</span>
            <!-- HOOK: level-pill -->
          </div>
        </div>
      </div>
    </header>

    <!-- ========================================================
         BLOCK 5 ‚Äî Main Content
    ========================================================= -->
    <main id="mainContent" class="main" role="main"> <!-- HOOK: main -->
      <div class="container">
        <!-- Progress row -->
        <section class="panel panel--tight" aria-label="Progression">
          <div class="panel__row panel__row--stack">
            <div>
              <div class="label muted">Progress</div>
              <div class="value" aria-live="polite">
                <span id="xpLabel">XP: 0</span>
                <span class="sep" aria-hidden="true">‚Ä¢</span>
                <span id="pointsLabel">Po√§ng: 0</span>
                <span class="sep" aria-hidden="true">‚Ä¢</span>
                <span id="streakLabel">Streak: 0</span>
              </div>
              <!-- HOOK: progress-labels -->
            </div>

            <div class="rightRow">
              <span id="activeMissionPill" class="pill pill--muted" aria-live="polite">Inget uppdrag valt</span>
              <!-- HOOK: active-mission-pill -->
            </div>
          </div>
        </section>

        <!-- ======================================================
             BLOCK 5.1 ‚Äî Difficulty segmented control (KRAV)
        ======================================================= -->
        <section class="panel panel--tight" aria-label="Sv√•righet" style="margin-top:12px">
          <div class="segRow">
            <div class="segLabel">
              <div class="label muted">Sv√•righet</div>
              <div id="difficultyInfo" class="muted small">
                V√§lj niv√• f√∂r att filtrera uppdrag.
              </div>
              <!-- HOOK: difficulty-info -->
            </div>

            <div class="segmented" role="tablist" aria-label="V√§lj sv√•righet" data-hook="difficulty-toggle">
              <!-- HOOK: difficulty-toggle -->
              <button id="diffEasyBtn" class="segBtn is-active" type="button" role="tab" aria-selected="true" aria-controls="missionsList">
                Easy
              </button>
              <!-- HOOK: diff-easy -->

              <button id="diffNormalBtn" class="segBtn" type="button" role="tab" aria-selected="false" aria-controls="missionsList" aria-disabled="true" disabled>
                Normal
              </button>
              <!-- HOOK: diff-normal -->
            </div>
          </div>

          <!-- Lock hint (visas n√§r normal √§r l√•st) -->
          <div id="unlockHintRow" class="unlockRow" hidden>
            <span class="unlockIcon" aria-hidden="true">üîí</span>
            <span id="unlockHintText" class="muted small">L√•s upp efter 15 klarade</span>
            <!-- HOOK: unlock-hint -->
          </div>
        </section>

        <!-- Error / loading slot -->
        <div id="statusSlot" class="slot" aria-live="polite">
          <!-- HOOK: status-slot -->
        </div>

        <!-- Active mission card -->
        <section id="missionCard" class="card card--mission" hidden aria-label="Aktivt uppdrag">
          <!-- HOOK: mission-card -->
          <div class="card__head">
            <div class="card__meta">
              <h2 id="missionTitle" class="card__title">‚Äî</h2>
              <!-- HOOK: mission-title -->
              <p id="missionInstruction" class="card__desc muted">‚Äî</p>
              <!-- HOOK: mission-instruction -->
            </div>

            <div class="card__side">
              <span id="difficultyPill" class="pill pill--difficulty" aria-label="Sv√•righetsgrad">easy</span>
              <!-- HOOK: difficulty-pill -->
            </div>
          </div>
          <!-- HOOK: camera-slot (JS mountar) -->
        </section>

        <!-- Missions list -->
        <section class="card card--list" aria-label="Uppdragslista">
          <div class="listHead">
            <h3 class="h2">Uppdrag</h3>
            <p class="muted small">V√§lj ett uppdrag f√∂r att aktivera ‚ÄúKlar‚Äù.</p>
          </div>

          <div id="missionsList" class="missionsList" role="list" aria-label="Uppdrag">
            <!-- HOOK: missions-list -->
          </div>
        </section>

        <div class="muted small footerNote">
          Easy/Normal filtrerar uppdragen. Normal l√•ses upp efter tillr√§ckligt m√•nga klarade.
        </div>
      </div>
    </main>

    <!-- Sticky CTA bar -->
    <div class="ctaBar" role="region" aria-label="√Ötg√§rder">
      <div class="ctaBar__inner">
        <button id="completeBtn" class="btn btn-primary" type="button" disabled aria-label="Markera uppdrag som klart">
          Klar
        </button>
        <!-- HOOK: complete-button -->

        <button id="switchBtn" class="btn btn-ghost" type="button" aria-label="Byt uppdrag">
          Byt uppdrag
        </button>
        <!-- HOOK: switch-mission-button -->
      </div>
    </div>
  </div>

  <!-- ==========================================================
       BLOCK 6 ‚Äî Page-only inline styles
  =========================================================== -->
  <style>
    .row { display:flex; align-items:center; gap: var(--sp-3); }
    .row--header { width:100%; }
    .btn--icon { width:44px; padding: 10px 10px; }
    .headerTitle { flex: 1; min-width: 0; }
    .headerName { font-weight: 800; font-size: var(--fs-4); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .headerRight { display:flex; align-items:center; gap: var(--sp-2); }

    .pill { display:inline-flex; align-items:center; justify-content:center; padding: 7px 10px; border-radius: 999px; border: 1px solid var(--border); background: rgba(255,255,255,.06); font-weight: 800; font-size: var(--fs-1); }
    .pill--level { border-color: rgba(110,231,255,.30); background: rgba(110,231,255,.10); color: rgba(255,255,255,.92); }
    .pill--difficulty { border-color: rgba(255,255,255,.14); }
    .pill--muted { opacity: .9; }

    .sep { opacity:.5; padding: 0 6px; }
    .panel--tight { padding: var(--sp-3); }
    .panel__row--stack { align-items:flex-start; }
    .rightRow { display:flex; align-items:center; justify-content:flex-end; }
    .slot { margin-top: var(--sp-4); }

    /* Segmented control */
    .segRow { display:flex; align-items:flex-start; justify-content:space-between; gap: var(--sp-3); }
    .segLabel { min-width:0; }
    .segmented {
      display:flex;
      gap: 6px;
      padding: 6px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.05);
      flex: 0 0 auto;
    }
    .segBtn {
      min-height: 44px;
      padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid transparent;
      background: transparent;
      color: var(--text);
      font-weight: 900;
      cursor: pointer;
    }
    .segBtn.is-active {
      background: rgba(110,231,255,.12);
      border-color: rgba(110,231,255,.30);
      box-shadow: var(--sh-1);
    }
    .segBtn:disabled,
    .segBtn[aria-disabled="true"] {
      opacity: .55;
      cursor: not-allowed;
    }

    .unlockRow {
      margin-top: 8px;
      display:flex;
      align-items:center;
      gap: 8px;
      padding: 8px 10px;
      border-radius: 14px;
      border: 1px solid rgba(251,191,36,.30);
      background: rgba(251,191,36,.08);
    }
    .unlockIcon { width: 22px; text-align:center; }

    .card--mission { margin-top: var(--sp-4); }
    .card__side { display:flex; align-items:flex-start; justify-content:flex-end; }
    .card--list { margin-top: var(--sp-4); }
    .listHead { margin-bottom: var(--sp-3); }
    .missionsList { display:grid; gap: var(--sp-2); }

    .missionItem { display:flex; align-items:center; justify-content:space-between; gap: var(--sp-3); padding: var(--sp-3); border-radius: var(--r-3); border: 1px solid var(--border); background: rgba(255,255,255,.04); cursor:pointer; user-select:none; }
    .missionItem:hover { border-color: rgba(110,231,255,.25); background: rgba(255,255,255,.05); }
    .missionItem.is-active { border-color: rgba(110,231,255,.55); background: rgba(110,231,255,.08); }
    .missionItem__meta { min-width:0; }
    .missionItem__title { font-weight: 800; white-space: nowrap; overflow:hidden; text-overflow: ellipsis; }
    .missionItem__sub { margin-top: 2px; font-size: var(--fs-1); }

    .footerNote { margin-top: var(--sp-5); text-align:center; opacity:.85; }

    .ctaBar {
      position: sticky;
      bottom: 0; left:0; right:0;
      z-index: 20;
      padding: var(--sp-3) var(--sp-4);
      padding-bottom: calc(var(--sp-3) + env(safe-area-inset-bottom, 0px));
      background: rgba(5,10,20,.75);
      border-top: 1px solid var(--border);
      backdrop-filter: blur(10px);
    }
    .ctaBar__inner { max-width: var(--container); margin: 0 auto; display:flex; gap: var(--sp-2); }
    .ctaBar__inner .btn { flex: 1; }
  </style>

  <!-- Script -->
  <script type="module" src="../src/play.js"></script>
</body>
</html>
